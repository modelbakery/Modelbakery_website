---
title: 'The Practical Approach of Multiple Linear Regression Model'
author: Package Build
date: '2021-11-03'
slug: back-to-the-basic-what-is-regression-function
categories:
  - R
tags:
  - Academic
  - Regression
  - Model Interpretation
  - R
subtitle: 'A general class of regression models and how to interpret these models'
summary: ''
authors: []
lastmod: '2021-11-03T13:30:59+09:00'
featured: no 
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
draft: TRUE
---

<script src="{{< blogdown/postref >}}index.en_files/header-attrs/header-attrs.js"></script>
<script src="{{< blogdown/postref >}}index.en_files/kePrint/kePrint.js"></script>
<link href="{{< blogdown/postref >}}index.en_files/lightable/lightable.css" rel="stylesheet" />


<div id="why-linear-regression" class="section level2">
<h2>Why linear regression?</h2>
<p>I always had this wonder. How do we know in what situation, the linear approximation is reasonable assumption to be made? - Well, most of the times never. Does that make linear regression any less vulable? Absolutley not, right?</p>
<blockquote>
<p>“If I had an hour to solve a problem and my life depended on the solution, I would spend the first 55 minutes determining the proper question to ask … for once I know the proper question, I could solve the problem in less than five minutes.”
—Albert Einstein</p>
</blockquote>
<p>I believe that the more complicated the problem is, the more important its interpretation becomes. In other words, we should always consider the possibility of simpler way to approach any form of problems.</p>
</div>
<div id="load-libraries" class="section level2">
<h2>Load Libraries</h2>
<pre class="r"><code>library(MASS)
library(ISLR)

library(tidyverse)
library(psych)
library(skimr)
library(car)
library(janitor)
library(tidyquant)
library(lares)
library(leaps)
library(broom)

library(caret)
library(tidymodels)
library(vip) 

library(hrbrthemes)
library(GGally)
library(viridis)
library(kableExtra)
library(gridExtra)</code></pre>
<pre class="r"><code>data(Boston)

describe(Boston) %&gt;% kbl() %&gt;% kable_minimal()</code></pre>
<table class=" lightable-minimal" style="font-family: &quot;Trebuchet MS&quot;, verdana, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
vars
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
trimmed
</th>
<th style="text-align:right;">
mad
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
range
</th>
<th style="text-align:right;">
skew
</th>
<th style="text-align:right;">
kurtosis
</th>
<th style="text-align:right;">
se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
crim
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
3.6135236
</td>
<td style="text-align:right;">
8.6015451
</td>
<td style="text-align:right;">
0.25651
</td>
<td style="text-align:right;">
1.6816300
</td>
<td style="text-align:right;">
0.3283218
</td>
<td style="text-align:right;">
0.00632
</td>
<td style="text-align:right;">
88.9762
</td>
<td style="text-align:right;">
88.96988
</td>
<td style="text-align:right;">
5.1922223
</td>
<td style="text-align:right;">
36.5958159
</td>
<td style="text-align:right;">
0.3823853
</td>
</tr>
<tr>
<td style="text-align:left;">
zn
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
11.3636364
</td>
<td style="text-align:right;">
23.3224530
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
5.0800493
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100.0000
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
2.2124881
</td>
<td style="text-align:right;">
3.9523873
</td>
<td style="text-align:right;">
1.0368095
</td>
</tr>
<tr>
<td style="text-align:left;">
indus
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
11.1367787
</td>
<td style="text-align:right;">
6.8603529
</td>
<td style="text-align:right;">
9.69000
</td>
<td style="text-align:right;">
10.9318719
</td>
<td style="text-align:right;">
9.3700320
</td>
<td style="text-align:right;">
0.46000
</td>
<td style="text-align:right;">
27.7400
</td>
<td style="text-align:right;">
27.28000
</td>
<td style="text-align:right;">
0.2932747
</td>
<td style="text-align:right;">
-1.2401949
</td>
<td style="text-align:right;">
0.3049799
</td>
</tr>
<tr>
<td style="text-align:left;">
chas
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
0.0691700
</td>
<td style="text-align:right;">
0.2539940
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
3.3857377
</td>
<td style="text-align:right;">
9.4819703
</td>
<td style="text-align:right;">
0.0112914
</td>
</tr>
<tr>
<td style="text-align:left;">
nox
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
0.5546951
</td>
<td style="text-align:right;">
0.1158777
</td>
<td style="text-align:right;">
0.53800
</td>
<td style="text-align:right;">
0.5450601
</td>
<td style="text-align:right;">
0.1297275
</td>
<td style="text-align:right;">
0.38500
</td>
<td style="text-align:right;">
0.8710
</td>
<td style="text-align:right;">
0.48600
</td>
<td style="text-align:right;">
0.7249897
</td>
<td style="text-align:right;">
-0.0874106
</td>
<td style="text-align:right;">
0.0051514
</td>
</tr>
<tr>
<td style="text-align:left;">
rm
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
6.2846344
</td>
<td style="text-align:right;">
0.7026171
</td>
<td style="text-align:right;">
6.20850
</td>
<td style="text-align:right;">
6.2528744
</td>
<td style="text-align:right;">
0.5122383
</td>
<td style="text-align:right;">
3.56100
</td>
<td style="text-align:right;">
8.7800
</td>
<td style="text-align:right;">
5.21900
</td>
<td style="text-align:right;">
0.4012223
</td>
<td style="text-align:right;">
1.8418324
</td>
<td style="text-align:right;">
0.0312351
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
68.5749012
</td>
<td style="text-align:right;">
28.1488614
</td>
<td style="text-align:right;">
77.50000
</td>
<td style="text-align:right;">
71.1960591
</td>
<td style="text-align:right;">
28.9848300
</td>
<td style="text-align:right;">
2.90000
</td>
<td style="text-align:right;">
100.0000
</td>
<td style="text-align:right;">
97.10000
</td>
<td style="text-align:right;">
-0.5954162
</td>
<td style="text-align:right;">
-0.9780297
</td>
<td style="text-align:right;">
1.2513695
</td>
</tr>
<tr>
<td style="text-align:left;">
dis
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
3.7950427
</td>
<td style="text-align:right;">
2.1057101
</td>
<td style="text-align:right;">
3.20745
</td>
<td style="text-align:right;">
3.5393786
</td>
<td style="text-align:right;">
1.9142590
</td>
<td style="text-align:right;">
1.12960
</td>
<td style="text-align:right;">
12.1265
</td>
<td style="text-align:right;">
10.99690
</td>
<td style="text-align:right;">
1.0057898
</td>
<td style="text-align:right;">
0.4575916
</td>
<td style="text-align:right;">
0.0936102
</td>
</tr>
<tr>
<td style="text-align:left;">
rad
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
9.5494071
</td>
<td style="text-align:right;">
8.7072594
</td>
<td style="text-align:right;">
5.00000
</td>
<td style="text-align:right;">
8.7339901
</td>
<td style="text-align:right;">
2.9652000
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
24.0000
</td>
<td style="text-align:right;">
23.00000
</td>
<td style="text-align:right;">
0.9988651
</td>
<td style="text-align:right;">
-0.8789291
</td>
<td style="text-align:right;">
0.3870849
</td>
</tr>
<tr>
<td style="text-align:left;">
tax
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
408.2371542
</td>
<td style="text-align:right;">
168.5371161
</td>
<td style="text-align:right;">
330.00000
</td>
<td style="text-align:right;">
400.0443350
</td>
<td style="text-align:right;">
108.2298000
</td>
<td style="text-align:right;">
187.00000
</td>
<td style="text-align:right;">
711.0000
</td>
<td style="text-align:right;">
524.00000
</td>
<td style="text-align:right;">
0.6659891
</td>
<td style="text-align:right;">
-1.1503176
</td>
<td style="text-align:right;">
7.4923887
</td>
</tr>
<tr>
<td style="text-align:left;">
ptratio
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
18.4555336
</td>
<td style="text-align:right;">
2.1649455
</td>
<td style="text-align:right;">
19.05000
</td>
<td style="text-align:right;">
18.6625616
</td>
<td style="text-align:right;">
1.7049900
</td>
<td style="text-align:right;">
12.60000
</td>
<td style="text-align:right;">
22.0000
</td>
<td style="text-align:right;">
9.40000
</td>
<td style="text-align:right;">
-0.7975743
</td>
<td style="text-align:right;">
-0.3048010
</td>
<td style="text-align:right;">
0.0962436
</td>
</tr>
<tr>
<td style="text-align:left;">
black
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
356.6740316
</td>
<td style="text-align:right;">
91.2948644
</td>
<td style="text-align:right;">
391.44000
</td>
<td style="text-align:right;">
383.1695074
</td>
<td style="text-align:right;">
8.0949960
</td>
<td style="text-align:right;">
0.32000
</td>
<td style="text-align:right;">
396.9000
</td>
<td style="text-align:right;">
396.58000
</td>
<td style="text-align:right;">
-2.8732597
</td>
<td style="text-align:right;">
7.1037150
</td>
<td style="text-align:right;">
4.0585518
</td>
</tr>
<tr>
<td style="text-align:left;">
lstat
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
12.6530632
</td>
<td style="text-align:right;">
7.1410615
</td>
<td style="text-align:right;">
11.36000
</td>
<td style="text-align:right;">
11.8990394
</td>
<td style="text-align:right;">
7.1090670
</td>
<td style="text-align:right;">
1.73000
</td>
<td style="text-align:right;">
37.9700
</td>
<td style="text-align:right;">
36.24000
</td>
<td style="text-align:right;">
0.9010929
</td>
<td style="text-align:right;">
0.4628171
</td>
<td style="text-align:right;">
0.3174589
</td>
</tr>
<tr>
<td style="text-align:left;">
medv
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
22.5328063
</td>
<td style="text-align:right;">
9.1971041
</td>
<td style="text-align:right;">
21.20000
</td>
<td style="text-align:right;">
21.5623153
</td>
<td style="text-align:right;">
5.9304000
</td>
<td style="text-align:right;">
5.00000
</td>
<td style="text-align:right;">
50.0000
</td>
<td style="text-align:right;">
45.00000
</td>
<td style="text-align:right;">
1.1015373
</td>
<td style="text-align:right;">
1.4509837
</td>
<td style="text-align:right;">
0.4088611
</td>
</tr>
</tbody>
</table>
</div>
<div id="understanding-data-boston-housing-data" class="section level2">
<h2>Understanding Data: Boston Housing Data</h2>
<div id="aim-of-the-analysis" class="section level4">
<h4>Aim of the Analysis</h4>
<p>The Boston Housing data set was analysed by Harrison and Rubinfeld, who wanted to find out whether “clean air” had an influence on house prices.</p>
</div>
<div id="segmenting-variables-macro-to-micro" class="section level4">
<h4>Segmenting Variables: Macro to Micro</h4>
<p>[1] Macro{External Influence}</p>
<p><strong>chas</strong>: Charles River dummy variable (= 1 if tract bounds river; 0 otherwise).</p>
<p><strong>age</strong>: proportion of owner-occupied units built prior to 1940.</p>
<p>[2] Industry/land/district</p>
<p><strong>zn</strong>: proportion of residential land zoned for lots over 25,000 sq.ft.</p>
<p><strong>indus</strong>: proportion of non-retail business acres per town.</p>
<p><strong>dis</strong>: weighted mean of distances to five Boston employment centres.</p>
<p><strong>rad</strong>: index of accessibility to radial highways.</p>
<p>[3] Population</p>
<p><strong>lstat</strong>: lower status of the population (percent).</p>
<p><strong>black</strong>: 1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town.</p>
<p><strong>ptratio</strong>: pupil-teacher ratio by town.</p>
<p>[3] Cause/result</p>
<p><strong>nox</strong>: nitrogen oxides concentration (parts per 10 million)</p>
<p><strong>tax</strong>: full-value property-tax rate per $10,000.</p>
<p><strong>crim</strong>: per capita crime rate by town.</p>
<p>[4] Direct influence</p>
<p><strong>rm</strong>: average number of rooms per dwelling.</p>
<p>[5] Target variable</p>
<p><strong>medv</strong>: median value of owner-occupied homes in $1000s.</p>
</div>
</div>
<div id="distribution-of-target-variable" class="section level2">
<h2>Distribution of Target Variable</h2>
<pre class="r"><code># Data preparation: logarithm target medv 
lBoston &lt;- Boston %&gt;% 
  mutate(log_medv = log(medv))
  
# Distribution of target medv 
P_medv &lt;- ggplot(Boston, aes(x = medv)) +
  geom_density(aes(x = medv, y = ..density..)) +
    geom_density(color=&quot;black&quot;, lwd =1.5, fill = viridisLite::viridis(n = 20)[3], alpha = 0.8)  +
    stat_function(fun=dnorm, 
                args = list(mean=mean(Boston$medv),
                            sd=sd(Boston$medv)),
                color=viridisLite::viridis(n = 20)[20], lwd = 1) +
  theme_minimal()

# Distribution of logarithm target medv 
P_lmedv &lt;- lBoston %&gt;% 
  ggplot(aes(x = log_medv)) +
  geom_density(aes(x = log_medv, y = ..density..)) +
    geom_density(color=&quot;black&quot;, lwd =1.5, fill = viridisLite::viridis(n = 20)[3], alpha = 0.8)  +
    stat_function(fun=dnorm, 
                args = list(mean=mean(lBoston$log_medv),
                            sd=sd(lBoston$log_medv)),
                color=viridisLite::viridis(n = 20)[20], lwd = 1) +
  theme_minimal()

# Shapiro-Wilk normality test: Both rejects the Null Hypothesis stating that the target data does not fit the normal distribution with 95% confidence. Significant departure from normality was found. 
shapiro.test(Boston$medv)$p.value</code></pre>
<pre><code>## [1] 4.941386e-16</code></pre>
<pre class="r"><code>shapiro.test(lBoston$log_medv)$p.value</code></pre>
<pre><code>## [1] 1.935427e-07</code></pre>
<pre class="r"><code>par(mfrow = c(1,2))
qqnorm(Boston$medv); qqline(Boston$medv, col =2)
qqnorm(lBoston$log_medv); qqline(lBoston$log_medv, col =2)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>grid.arrange(P_medv, P_lmedv)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-3-2.png" width="672" />
By looking at the p-values, the log transform departure less significant from normality hence I will carry logarithm medv. The R squared estimatation will be computed after inversion using exponent function. <Must Remember></p>
</div>
<div id="visualisation-boxplot-histogram" class="section level2">
<h2>Visualisation: Boxplot &amp; Histogram</h2>
<ul>
<li><p>Scaling or transformation should be considered</p></li>
<li><p>Outlier treatment should be considered</p></li>
</ul>
<pre class="r"><code># Quick boxplot:
boxplot(Boston)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code># Customised facet histogram: can be found on my GitHub :)  
generator_hist_facet(lBoston, bins = 15, fill = viridisLite::viridis(n = 20)[1])</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
</div>
<div id="ggally-visualisation" class="section level2">
<h2>GGally Visualisation</h2>
<pre class="r"><code># Data preparation for GGally visualisation with observation split at meidan Y value. 
Boston_medv_median &lt;- Boston %&gt;% 
  mutate(median_medv_cutoff = ifelse(medv &gt; median(medv), 1, 0),
         median_medv_cutoff = as.factor(median_medv_cutoff)) 

# GGally ggpairs plot for variables upto age 
GGally::ggpairs(Boston_medv_median[ ,c(14,1:7, 15)],
                aes(color=median_medv_cutoff, alpha = 0.75),
                lower = list(continous = &quot;smooth&quot;)) +
  theme_bw() +
  scale_color_viridis_d(alpha = 0.7) +
  scale_fill_viridis_d(alpha = 0.7) +
  labs(
    title    = &quot;Correlation Matrix Plot for Boston Housing: crim ~ age&quot;,
    subtitle = &quot;Promising Separation of High &amp; Low target Subgroups by rm &amp; indus Predictor Vars&quot;,
    caption  = &quot;medv &gt; median(medv): Yellow
                medv ≤ meidan(medv): Purple&quot;,
  ) + 
  theme(plot.title = element_text(face = &#39;bold&#39;,
                                  colour = &#39;black&#39;,
                                  hjust = 0.5, size = 12)) </code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code># GGally ggpairs plot for variables from dis ~ lstat 
GGally::ggpairs(Boston_medv_median[ ,c(14,8:13,15)],
                aes(colour=median_medv_cutoff, alpha = 0.75),
                lower = list(continous = &quot;smooth&quot;)) +
  theme_bw() +
  labs(
    title    = &quot;Correlation Matrix Plot for Boston Housing: dis ~ lstat&quot;,
    subtitle = &quot;Promising Separation of High &amp; Low target Subgroups by black &amp; lstat Predictor Vars&quot;,
    caption  = &quot;medv &gt; median(medv): Yellow
                medv ≤ meidan(medv): Purple&quot;,
  ) +
  scale_color_viridis_d(alpha = 0.7) +
  scale_fill_viridis_d(alpha = 0.7) +
  theme(plot.title = element_text(face = &#39;bold&#39;,
                                  colour = &#39;black&#39;,
                                  hjust = 0.5, size = 12))</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<pre class="r"><code># Gally parallel coordinates plot {PCP}
Boston_medv_median %&gt;%
  arrange(desc(median_medv_cutoff)) %&gt;%
  ggparcoord(
    columns = 1:14, groupColumn = 15,
    scale=&quot;uniminmax&quot;,
    showPoints = FALSE,
    alphaLines = 1
    ) + 
  scale_color_viridis(discrete=TRUE)+
    labs(
    title = &quot;Parallel Coordinates Plot for Boston House Price: Minmax Standardised&quot;,
    subtitle = &quot;Strong negative connection observed between lstat &amp; medv&quot;,
    caption = &quot;medv &gt; median(medv): Yellow
               medv ≤ meidan(medv): Purple&quot;,
    y = &quot;Minmax scaled medv&quot;,
    x = &quot;&quot;) +
  theme_ipsum()+
  theme(
    legend.position=&quot;default&quot;,
    plot.title = element_text(size=15)
  )</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
<p>In order to highlight the relation of medv (target Y) to the remaining 13 variables, I have split the observations with medv &gt; median(medv) as <strong>yellow</strong> lines and rest as the <strong>purple</strong> line. Some of the variables seem to be strongly related. The most obvious relation is the negative dependence between lstat and medv.For better graphical representations, the variables have been minmax scaled over the interval [0,1]. There are variables where the observations are highly concnetrated at the low region, close to zero. By means, it makes sense to consider transformation of the original data.</p>
<ul>
<li>crim -&gt; lcrim (logarithm)
<ul>
<li>Taking the logarithm makes the variable’s distribution more symmetric. Its median and the mean have moved closer to each other then they were for the original crim.</li>
</ul></li>
<li>zn -&gt; zn (binning)
<ul>
<li>There is a large number of zero values.</li>
<li>There is a noticable non-linear negative relationship with crim, noticed on PCP. Almost all the observations for which zn = 0, have a high percapita crime rate, and vice versa.</li>
<li>On the concern of house price prediction, the correlation says that there seems to be no clear linear relationship with medv. However, the residential land over its common size would obviously lead to higher property price.</li>
</ul></li>
<li>indus -&gt; lindus (logarithm)
<ul>
<li>Negative correlation with target medv observed. The relationship between the logarithms of both variables seems to be almost linear. The negative relation might result from the noise non-retail business sometimes generates and other pollution aspects.</li>
<li>Strong linear correlation with nox. Greater the proportion of non-retail business, more likely to cause a pollution hence the high nox concentration.</li>
</ul></li>
<li>chas
<ul>
<li>There are some doubt that Charles River influences the house price. That said, the districts close to the Charles River would likely to influence other factors such as the pupil/teacher ratio or the proportion of non-retail business acres. Hence, their relation may be pure coincidence or some form of hierchical interaction.</li>
</ul></li>
<li>rm -&gt; lrm (logarithm)
<ul>
<li>The number of rooms per dwelling is a direct measure of the size of the houses. Thus, I suspect rm to be strongly correlated with the target medv.<br />
</li>
<li>Outlier treatment needed.</li>
</ul></li>
<li>age -&gt; age^2.5/10000
<ul>
<li>There is no clear sign of rlationship with the house price. On top of that, usually the time, date, age factor has connection with multiple variables, which likely to inflate the VIF factor and rise multicollinearity issue.</li>
<li>Left skewed</li>
</ul></li>
<li>dis -&gt; ldis (logarithm)
<ul>
<li>The scatter plot showed hardly any linear relationship with the target, house price. However, there is a noticable non-linear relation and its logarithm does seem to preserve distance influence on the house price.</li>
</ul></li>
<li>rad -&gt; lrad (logarithm)
<ul>
<li>The one obvious thing one can observe is the subgroups of districts containing rad value, which are lose to the respective group’s mean. The boxplot from ggpair reveals that the mean value of these subgroups stays relatively the same for both low and high price of the house.</li>
<li>Its correlation with tax exceeds 0.9</li>
</ul></li>
<li>tax -&gt; ltax (logarithm)
<ul>
<li>Likewise to rad, there is a noticable subgroups on the distribution of tax value. The scatter plot shows downward curve with increase in the tax rate. There are presence of outliers in lower value subgroup but the mean difference within these groups seems to be significant to retain its information.</li>
</ul></li>
<li>ptratio -&gt; exp(0.4*ptratio)/1000
<ul>
<li>The ggpair boxplot indicates negative relation with medv.</li>
<li>The mean values of its subgroups depart significantly by high and low regime of medv.</li>
<li>The kurtosis of of its red distribution {medv &lt; median(medv)} is highly noticeable hence likely be potential predictor variable on medv.</li>
</ul></li>
<li>black -&gt; black/100
<ul>
<li><a href="https://medium.com/@docintangible/racist-data-destruction-113e3eff54a8" class="uri">https://medium.com/@docintangible/racist-data-destruction-113e3eff54a8</a></li>
</ul></li>
<li>lstat -&gt; lstat^0.5
<ul>
<li>Of all the variables, lstat exhibits the strongest negative relation with medv (PCP &amp; ggpairs).</li>
<li>Taking the square root removes all the outliers and gains better relation with log(mdv)</li>
</ul></li>
</ul>
</div>
<div id="feature-transformation-asymmetry-reduction" class="section level2">
<h2>Feature Transformation &amp; Asymmetry reduction</h2>
<pre class="r"><code># feature transformation/scaling 
Boston_transform &lt;- Boston %&gt;% 
  summarise(lcrim    = log(crim + 1),
            zn       = zn/10,
            lindus   = log(indus),
            chas     = chas,
            lnox     = log(nox + 1),
            lrm      = log(rm),
            sqage    = (age^2.5)/10000,
            ldis     = log(dis),
            lrad     = log(rad),
            ltax     = log(tax),
            eptratio = exp(0.4*ptratio)/1000,
            black    = black/100,
            srlstat  = lstat^0.5,
            lmedv    = log(medv))

# Boxplots for all of the transformed variables + scaling 
Boston_transform %&gt;% 
  summarise_all(funs(x = scale(., center = TRUE, scale = TRUE))) %&gt;% 
  setNames(c(&quot;crim&quot;, &quot;zn&quot;, &quot;indus&quot;, &quot;chas&quot;, &quot;nox&quot;, &quot;rm&quot;, &quot;age&quot;, &quot;dis&quot;, &quot;rad&quot;, &quot;tax&quot;, &quot;ptratio&quot;, &quot;black&quot;, &quot;lstat&quot;, &quot;medv&quot;)) %&gt;% 
  gather(key = key, value = value, factor_key = TRUE) %&gt;% 
  ggplot(aes(key, value)) +
  geom_boxplot(fill = viridisLite::viridis(n = 20)[1], colour = &quot;yellow&quot;) +
  labs(
    title = &quot;Transformed Boston Housing Data&quot;,
    x = &quot;&quot;,
    y = &quot;Scaled Index&quot;
  ) +
  theme_dark() </code></pre>
<pre><code>## Warning: `funs()` was deprecated in dplyr 0.8.0.
## Please use a list of either functions or lambdas: 
## 
##   # Simple named list: 
##   list(mean = mean, median = median)
## 
##   # Auto named with `tibble::lst()`: 
##   tibble::lst(mean, median)
## 
##   # Using lambdas
##   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Since most of the variables exhibit an asymmetry with a higher density on the left-hand side (right skewed), the logarithm transformations are proposed on most of the variables. Taking the logarithm helps to reduce the asymmetry, pushing lower values to move further away from each other whereas the distance between greater values is reduced.</p>
<p>In comparison to original data, these transformed variables are more asymmetric and where logarithm was applied, the less outliers were shown. The question is: is the upper and/or extreme always an outlier? I believe there is no straight answer hence I will carry out this transformed data set and outlier treated data set as I go along the analysis.</p>
<div id="correlation-lares-package" class="section level4">
<h4>Correlation: lares package</h4>
<pre class="r"><code># Target variable correlation plot
corr_plot &lt;- corr_var(Boston_transform, 
  lmedv 
); corr_plot</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code># X&#39;s cross correlation plot: display only significant correlations (at 5% level)
corr_cross_plot &lt;- corr_cross(Boston_transform %&gt;% dplyr::select(-lmedv), 
  max_pvalue = 0.05,
  rm.na = FALSE
); corr_cross_plot</code></pre>
<pre><code>## Returning only the top 25. You may override with the &#39;top&#39; argument</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre class="r"><code># Capturing data into table: 
# @ TBD {Bind with variable coefficient statistics tbl}
corr_tbl &lt;- corr_plot$data %&gt;% dplyr::select(variables, corr)
corr_cross_tbl &lt;-corr_cross_plot$data %&gt;% dplyr::select(key, label, corr)</code></pre>
</div>
<div id="linear-model-original-vs-transformed-data-set" class="section level4">
<h4>Linear Model: Original VS Transformed Data Set</h4>
<pre class="r"><code># linear model on all variables 
lm_fit_00edit &lt;- lm(medv~., data = Boston); summary(lm_fit_00edit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = medv ~ ., data = Boston)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -15.595  -2.730  -0.518   1.777  26.199 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.646e+01  5.103e+00   7.144 3.28e-12 ***
## crim        -1.080e-01  3.286e-02  -3.287 0.001087 ** 
## zn           4.642e-02  1.373e-02   3.382 0.000778 ***
## indus        2.056e-02  6.150e-02   0.334 0.738288    
## chas         2.687e+00  8.616e-01   3.118 0.001925 ** 
## nox         -1.777e+01  3.820e+00  -4.651 4.25e-06 ***
## rm           3.810e+00  4.179e-01   9.116  &lt; 2e-16 ***
## age          6.922e-04  1.321e-02   0.052 0.958229    
## dis         -1.476e+00  1.995e-01  -7.398 6.01e-13 ***
## rad          3.060e-01  6.635e-02   4.613 5.07e-06 ***
## tax         -1.233e-02  3.760e-03  -3.280 0.001112 ** 
## ptratio     -9.527e-01  1.308e-01  -7.283 1.31e-12 ***
## black        9.312e-03  2.686e-03   3.467 0.000573 ***
## lstat       -5.248e-01  5.072e-02 -10.347  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.745 on 492 degrees of freedom
## Multiple R-squared:  0.7406, Adjusted R-squared:  0.7338 
## F-statistic: 108.1 on 13 and 492 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code># linear model on all transformed variables 
lm_fit_01edit &lt;- lm(lmedv~., data = Boston_transform); summary(lm_fit_01edit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = lmedv ~ ., data = Boston_transform)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.76335 -0.11160 -0.00628  0.09486  0.77234 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.441051   0.362100  12.265  &lt; 2e-16 ***
## lcrim       -0.134082   0.020402  -6.572 1.27e-10 ***
## zn           0.008149   0.005430   1.501 0.134044    
## lindus      -0.026409   0.021399  -1.234 0.217746    
## chas         0.103224   0.035160   2.936 0.003482 ** 
## lnox        -0.732228   0.256108  -2.859 0.004429 ** 
## lrm          0.394455   0.105705   3.732 0.000212 ***
## sqage        0.006549   0.004582   1.429 0.153581    
## ldis        -0.233468   0.035580  -6.562 1.35e-10 ***
## lrad         0.123402   0.020857   5.916 6.17e-09 ***
## ltax        -0.137077   0.047299  -2.898 0.003922 ** 
## eptratio    -0.038705   0.007797  -4.964 9.52e-07 ***
## black        0.028878   0.011117   2.598 0.009665 ** 
## srlstat     -0.249070   0.015554 -16.014  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1925 on 492 degrees of freedom
## Multiple R-squared:  0.784,  Adjusted R-squared:  0.7783 
## F-statistic: 137.3 on 13 and 492 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>glance(lm_fit_00edit) %&gt;% kbl %&gt;% kable_material()</code></pre>
<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
r.squared
</th>
<th style="text-align:right;">
adj.r.squared
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:right;">
deviance
</th>
<th style="text-align:right;">
df.residual
</th>
<th style="text-align:right;">
nobs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.7406427
</td>
<td style="text-align:right;">
0.7337897
</td>
<td style="text-align:right;">
4.745298
</td>
<td style="text-align:right;">
108.0767
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
-1498.804
</td>
<td style="text-align:right;">
3027.609
</td>
<td style="text-align:right;">
3091.007
</td>
<td style="text-align:right;">
11078.78
</td>
<td style="text-align:right;">
492
</td>
<td style="text-align:right;">
506
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>glance(lm_fit_01edit) %&gt;% kbl %&gt;% kable_material()</code></pre>
<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
r.squared
</th>
<th style="text-align:right;">
adj.r.squared
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:right;">
deviance
</th>
<th style="text-align:right;">
df.residual
</th>
<th style="text-align:right;">
nobs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.7839604
</td>
<td style="text-align:right;">
0.7782521
</td>
<td style="text-align:right;">
0.1924841
</td>
<td style="text-align:right;">
137.3354
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
122.8731
</td>
<td style="text-align:right;">
-215.7462
</td>
<td style="text-align:right;">
-152.3482
</td>
<td style="text-align:right;">
18.22866
</td>
<td style="text-align:right;">
492
</td>
<td style="text-align:right;">
506
</td>
</tr>
</tbody>
</table>
<p>From the summary statistics computed with glance function, it is clear that asymmetric reduced data having positive influence on the overall accuracy of the linear model and OLS approach.</p>
<ul>
<li><p>Higher R-squared &amp; adj.R-squared, and lower AIC &amp; BIC</p></li>
<li><p>Less number of statistically significant variables depicted (t_value &gt; 2) on the model. Optimal parameters</p></li>
</ul>
<p>Depending on the nature of task (target variable: Boston House Price) the predictors will vary in weight of importance between the interpretation and the accuracy. Having skewed data will have tendency to hide these importance and its information have on the House Price. By default, it is our challenge to align these distributions in respect to, ideally normally distributed, Y in order to protect loss on valuable information.</p>
<p>Understanding that skewness and scale are different is important, it can be easily seen from its result on t-statistics and correlation coefficients. It can be seem non-ordinary to split the numeric target variable into two subgroups during the data interpretation. However, as seen above, it adds more visual interpretation than having correlation matrix alone. I believe this approach can also be powerful in recognising hierarchical relationships between the variable X’s.</p>
</div>
</div>
<div id="summary-table-for-variable-coefficient-correlation" class="section level2">
<h2>Summary table for variable coefficient &amp; correlation</h2>
<p>One of the aspect in regression is the multi-colinearity issue. Although a thorough investigation in variable correlation can be useful but it merely highlights on confounders and its effect sizes. I like to imagine multi-colinearity as the entaglements of features in given dimensional space, and without the any knowelgde on the subject, it holds risk of miss-interpreting the what’s in behind the scene, as I like to phrase ultimate “route cause”.</p>
<p>Multi-colinearity and robust regression is one of my keen interest and would like to discover further and share. Hopefully in the next post :)</p>
<pre class="r"><code>var_names &lt;- colnames(Boston_transform %&gt;% dplyr::select(lmedv, everything()))

summary_relationship_tbl &lt;- summary(lm_fit_00edit)$coefficients[,c(1,3:4)] %&gt;% 
  as_tibble() %&gt;% 
  cbind(var_names) %&gt;% 
  dplyr::select(var_names, everything()) %&gt;% 
  left_join(corr_tbl, by = c(&quot;var_names&quot; = &quot;variables&quot;)) %&gt;% 
  left_join(corr_cross_tbl, by = c(&quot;var_names&quot; = &quot;key&quot;)) %&gt;% 
  setNames(c(&quot;var_names&quot;, &quot;Estimate&quot;, &quot;t_stats&quot;, &quot;p_value&quot;, &quot;corr&quot;, &quot;label&quot;, &quot;cross_corr&quot;)) %&gt;% 
  arrange(cross_corr)

summary_relationship_tbl %&gt;% kbl() %&gt;% kable_material()</code></pre>
<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
var_names
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
t_stats
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
corr
</th>
<th style="text-align:left;">
label
</th>
<th style="text-align:right;">
cross_corr
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
lnox
</td>
<td style="text-align:right;">
-17.7666112
</td>
<td style="text-align:right;">
-4.6512574
</td>
<td style="text-align:right;">
0.0000042
</td>
<td style="text-align:right;">
-0.513735
</td>
<td style="text-align:left;">
lnox + ldis
</td>
<td style="text-align:right;">
-0.843877
</td>
</tr>
<tr>
<td style="text-align:left;">
sqage
</td>
<td style="text-align:right;">
0.0006922
</td>
<td style="text-align:right;">
0.0524024
</td>
<td style="text-align:right;">
0.9582293
</td>
<td style="text-align:right;">
-0.482096
</td>
<td style="text-align:left;">
sqage + ldis
</td>
<td style="text-align:right;">
-0.795991
</td>
</tr>
<tr>
<td style="text-align:left;">
lindus
</td>
<td style="text-align:right;">
0.0205586
</td>
<td style="text-align:right;">
0.3343100
</td>
<td style="text-align:right;">
0.7382881
</td>
<td style="text-align:right;">
-0.553887
</td>
<td style="text-align:left;">
lindus + ldis
</td>
<td style="text-align:right;">
-0.730297
</td>
</tr>
<tr>
<td style="text-align:left;">
lcrim
</td>
<td style="text-align:right;">
-0.1080114
</td>
<td style="text-align:right;">
-3.2865169
</td>
<td style="text-align:right;">
0.0010868
</td>
<td style="text-align:right;">
-0.599781
</td>
<td style="text-align:left;">
lcrim + ldis
</td>
<td style="text-align:right;">
-0.676479
</td>
</tr>
<tr>
<td style="text-align:left;">
zn
</td>
<td style="text-align:right;">
0.0464205
</td>
<td style="text-align:right;">
3.3815763
</td>
<td style="text-align:right;">
0.0007781
</td>
<td style="text-align:right;">
0.363344
</td>
<td style="text-align:left;">
zn + lindus
</td>
<td style="text-align:right;">
-0.655898
</td>
</tr>
<tr>
<td style="text-align:left;">
lrm
</td>
<td style="text-align:right;">
3.8098652
</td>
<td style="text-align:right;">
9.1161402
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.610437
</td>
<td style="text-align:left;">
lrm + srlstat
</td>
<td style="text-align:right;">
-0.639439
</td>
</tr>
<tr>
<td style="text-align:left;">
ldis
</td>
<td style="text-align:right;">
-1.4755668
</td>
<td style="text-align:right;">
-7.3980036
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.405721
</td>
<td style="text-align:left;">
ldis + ltax
</td>
<td style="text-align:right;">
-0.599621
</td>
</tr>
<tr>
<td style="text-align:left;">
lindus
</td>
<td style="text-align:right;">
0.0205586
</td>
<td style="text-align:right;">
0.3343100
</td>
<td style="text-align:right;">
0.7382881
</td>
<td style="text-align:right;">
-0.553887
</td>
<td style="text-align:left;">
lindus + lrad
</td>
<td style="text-align:right;">
0.580533
</td>
</tr>
<tr>
<td style="text-align:left;">
zn
</td>
<td style="text-align:right;">
0.0464205
</td>
<td style="text-align:right;">
3.3815763
</td>
<td style="text-align:right;">
0.0007781
</td>
<td style="text-align:right;">
0.363344
</td>
<td style="text-align:left;">
zn + ldis
</td>
<td style="text-align:right;">
0.590655
</td>
</tr>
<tr>
<td style="text-align:left;">
lcrim
</td>
<td style="text-align:right;">
-0.1080114
</td>
<td style="text-align:right;">
-3.2865169
</td>
<td style="text-align:right;">
0.0010868
</td>
<td style="text-align:right;">
-0.599781
</td>
<td style="text-align:left;">
lcrim + srlstat
</td>
<td style="text-align:right;">
0.591480
</td>
</tr>
<tr>
<td style="text-align:left;">
lnox
</td>
<td style="text-align:right;">
-17.7666112
</td>
<td style="text-align:right;">
-4.6512574
</td>
<td style="text-align:right;">
0.0000042
</td>
<td style="text-align:right;">
-0.513735
</td>
<td style="text-align:left;">
lnox + srlstat
</td>
<td style="text-align:right;">
0.602493
</td>
</tr>
<tr>
<td style="text-align:left;">
lcrim
</td>
<td style="text-align:right;">
-0.1080114
</td>
<td style="text-align:right;">
-3.2865169
</td>
<td style="text-align:right;">
0.0010868
</td>
<td style="text-align:right;">
-0.599781
</td>
<td style="text-align:left;">
lcrim + sqage
</td>
<td style="text-align:right;">
0.604537
</td>
</tr>
<tr>
<td style="text-align:left;">
lnox
</td>
<td style="text-align:right;">
-17.7666112
</td>
<td style="text-align:right;">
-4.6512574
</td>
<td style="text-align:right;">
0.0000042
</td>
<td style="text-align:right;">
-0.513735
</td>
<td style="text-align:left;">
lnox + lrad
</td>
<td style="text-align:right;">
0.604894
</td>
</tr>
<tr>
<td style="text-align:left;">
lindus
</td>
<td style="text-align:right;">
0.0205586
</td>
<td style="text-align:right;">
0.3343100
</td>
<td style="text-align:right;">
0.7382881
</td>
<td style="text-align:right;">
-0.553887
</td>
<td style="text-align:left;">
lindus + srlstat
</td>
<td style="text-align:right;">
0.621379
</td>
</tr>
<tr>
<td style="text-align:left;">
lcrim
</td>
<td style="text-align:right;">
-0.1080114
</td>
<td style="text-align:right;">
-3.2865169
</td>
<td style="text-align:right;">
0.0010868
</td>
<td style="text-align:right;">
-0.599781
</td>
<td style="text-align:left;">
lcrim + lindus
</td>
<td style="text-align:right;">
0.626457
</td>
</tr>
<tr>
<td style="text-align:left;">
sqage
</td>
<td style="text-align:right;">
0.0006922
</td>
<td style="text-align:right;">
0.0524024
</td>
<td style="text-align:right;">
0.9582293
</td>
<td style="text-align:right;">
-0.482096
</td>
<td style="text-align:left;">
sqage + srlstat
</td>
<td style="text-align:right;">
0.637140
</td>
</tr>
<tr>
<td style="text-align:left;">
lindus
</td>
<td style="text-align:right;">
0.0205586
</td>
<td style="text-align:right;">
0.3343100
</td>
<td style="text-align:right;">
0.7382881
</td>
<td style="text-align:right;">
-0.553887
</td>
<td style="text-align:left;">
lindus + sqage
</td>
<td style="text-align:right;">
0.658137
</td>
</tr>
<tr>
<td style="text-align:left;">
lindus
</td>
<td style="text-align:right;">
0.0205586
</td>
<td style="text-align:right;">
0.3343100
</td>
<td style="text-align:right;">
0.7382881
</td>
<td style="text-align:right;">
-0.553887
</td>
<td style="text-align:left;">
lindus + ltax
</td>
<td style="text-align:right;">
0.659285
</td>
</tr>
<tr>
<td style="text-align:left;">
lnox
</td>
<td style="text-align:right;">
-17.7666112
</td>
<td style="text-align:right;">
-4.6512574
</td>
<td style="text-align:right;">
0.0000042
</td>
<td style="text-align:right;">
-0.513735
</td>
<td style="text-align:left;">
lnox + ltax
</td>
<td style="text-align:right;">
0.665838
</td>
</tr>
<tr>
<td style="text-align:left;">
lcrim
</td>
<td style="text-align:right;">
-0.1080114
</td>
<td style="text-align:right;">
-3.2865169
</td>
<td style="text-align:right;">
0.0010868
</td>
<td style="text-align:right;">
-0.599781
</td>
<td style="text-align:left;">
lcrim + lnox
</td>
<td style="text-align:right;">
0.713491
</td>
</tr>
<tr>
<td style="text-align:left;">
lindus
</td>
<td style="text-align:right;">
0.0205586
</td>
<td style="text-align:right;">
0.3343100
</td>
<td style="text-align:right;">
0.7382881
</td>
<td style="text-align:right;">
-0.553887
</td>
<td style="text-align:left;">
lindus + lnox
</td>
<td style="text-align:right;">
0.735757
</td>
</tr>
<tr>
<td style="text-align:left;">
lnox
</td>
<td style="text-align:right;">
-17.7666112
</td>
<td style="text-align:right;">
-4.6512574
</td>
<td style="text-align:right;">
0.0000042
</td>
<td style="text-align:right;">
-0.513735
</td>
<td style="text-align:left;">
lnox + sqage
</td>
<td style="text-align:right;">
0.767939
</td>
</tr>
<tr>
<td style="text-align:left;">
lrad
</td>
<td style="text-align:right;">
0.3060495
</td>
<td style="text-align:right;">
4.6128998
</td>
<td style="text-align:right;">
0.0000051
</td>
<td style="text-align:right;">
-0.434513
</td>
<td style="text-align:left;">
lrad + ltax
</td>
<td style="text-align:right;">
0.820487
</td>
</tr>
<tr>
<td style="text-align:left;">
lcrim
</td>
<td style="text-align:right;">
-0.1080114
</td>
<td style="text-align:right;">
-3.2865169
</td>
<td style="text-align:right;">
0.0010868
</td>
<td style="text-align:right;">
-0.599781
</td>
<td style="text-align:left;">
lcrim + ltax
</td>
<td style="text-align:right;">
0.824690
</td>
</tr>
<tr>
<td style="text-align:left;">
lcrim
</td>
<td style="text-align:right;">
-0.1080114
</td>
<td style="text-align:right;">
-3.2865169
</td>
<td style="text-align:right;">
0.0010868
</td>
<td style="text-align:right;">
-0.599781
</td>
<td style="text-align:left;">
lcrim + lrad
</td>
<td style="text-align:right;">
0.838352
</td>
</tr>
<tr>
<td style="text-align:left;">
lmedv
</td>
<td style="text-align:right;">
36.4594884
</td>
<td style="text-align:right;">
7.1440742
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
chas
</td>
<td style="text-align:right;">
2.6867338
</td>
<td style="text-align:right;">
3.1183809
</td>
<td style="text-align:right;">
0.0019250
</td>
<td style="text-align:right;">
0.158412
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
ltax
</td>
<td style="text-align:right;">
-0.0123346
</td>
<td style="text-align:right;">
-3.2800091
</td>
<td style="text-align:right;">
0.0011116
</td>
<td style="text-align:right;">
-0.557184
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
eptratio
</td>
<td style="text-align:right;">
-0.9527472
</td>
<td style="text-align:right;">
-7.2825106
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.508224
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
black
</td>
<td style="text-align:right;">
0.0093117
</td>
<td style="text-align:right;">
3.4667926
</td>
<td style="text-align:right;">
0.0005729
</td>
<td style="text-align:right;">
0.402382
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
srlstat
</td>
<td style="text-align:right;">
-0.5247584
</td>
<td style="text-align:right;">
-10.3471458
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.825024
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
</div>
<div id="outlier-detection-on-fluential-observation-by-cooks-distance" class="section level2">
<h2>Outlier Detection: On Fluential Observation by Cook’s Distance</h2>
<p>The family of regression in nature sensitive to abnormal data points and there are many techniques to remove the outliers from the data set. In linear approach, the estimated Y’s are predicted by conditional average of X’s coordinates in individual instances. Hence it is a voting mechanism of all the points to estimate the line of the best fit. I like to imagine it as every data points tries to pull the line towards it selves, and some does more successfully than others: leverage.</p>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>In other words, if there are presence of extreme outlier situated far from the mean and rest of the coordinates, this leverage is likely to cause regression line distortion and thus the coefficient estimates.</p>
<p>A general notation for Cook’s Distance is given below:</p>
<p><span class="math display">\[
D_i = \frac{\sum_{j=1}^n(\hat{y_j} - \hat{y_{j(i)}})^2}{constant}  
\]</span></p>
<p>The equation denotes, how much influential effect does i observation have and it is computed by the difference of <span class="math inline">\(\ \hat{y_j}\)</span> (with i) and <span class="math inline">\(\ \hat{y_{j(i)}}\)</span> (without i) at all the <span class="math inline">\(\ y\)</span> values. If the parameter estimate change a great deal upon suspect outlier (leverage) deletion from the least squares estimate calculation, the point is said to be influential.</p>
<pre class="r"><code># plot Cook&#39;s distance
cooksd_outlier_detect &lt;- function(lm_fit){
  cooksd &lt;- cooks.distance(lm_fit)
  influential &lt;- as.numeric(names(cooksd)[(cooksd &gt; 4*mean(cooksd, na.rm=T))])
  return(influential)
}
cooksd_outlier_detect(lm_fit_01edit)</code></pre>
<pre><code>##  [1]   8 149 153 215 365 366 368 369 370 372 373 375 399 400 401 402 406 410 413
## [20] 417 420 490 491 506</code></pre>
<pre class="r"><code>cooksd_outlier_plot &lt;- function(lm_fit){
  cooksd &lt;- cooks.distance(lm_fit)
  plot(cooksd, pch=&quot;*&quot;, cex=2, main=&quot;Influential Obs by Cooks distance&quot;) +
    # I have relaxed the Cook&#39;s distance assumption to retain as much information as possible. 
    abline(h = 4*mean(cooksd, na.rm=T), col=&quot;red&quot;) +
    text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd&gt;4*mean(cooksd, na.rm=T),names(cooksd),&quot;&quot;), col=&quot;red&quot;)
}
cooksd_outlier_plot(lm_fit_01edit)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre><code>## integer(0)</code></pre>
<p>A general rule of thumb is to investigate any point that is more than 3 times the mean of all the distances. However, the log(y) (House Price) contain noticable outliers and there is a possibility that these target value upon deletion could be the reason for parameter estimate change. If the influential observation happen to be the Y actual value contribution, we would need to pull this set of observations separatelty and investigate further while making the prediction without this influential detected set.</p>
<pre class="r"><code># Vectorise outliers NA converter 
detect_outliers_to_na &lt;- function(x) {
  if (missing(x)) stop(&quot;The argument x needs a vector.&quot;)
  if (!is.numeric(x)) stop(&quot;The argument x must be numeric&quot;)
  data_tbl &lt;- tibble(data = x)
  limits_tbl &lt;- data_tbl %&gt;% 
    summarise(
      quantile_lo = quantile(data, probs = 0.25, na.rm = TRUE),
      quantile_hi = quantile(data, probs = 0.75, na.rm = TRUE),
      iqr = IQR(data, na.rm = TRUE),
      limit_lo = quantile_lo - 1.5 * iqr,
      limit_hi = quantile_hi + 1.5 * iqr
    )
    output_tbl &lt;- data_tbl %&gt;% 
    mutate(outlier = ifelse(data &lt; limits_tbl$limit_lo, NA,
                            ifelse(data &gt; limits_tbl$limit_hi, NA,
                                   data))
           )
  return(output_tbl$outlier)
}</code></pre>
<div id="outlier-treatment-1-predictor-varaibles-iqr-out-of-bound-outliers-treatment-at-detected-influential-observation" class="section level3">
<h3>Outlier Treatment #1: Predictor Varaibles IQR out-of-bound Outliers Treatment at Detected Influential Observation</h3>
<pre class="r"><code># Add Row Id 
Boston_row_tbl &lt;- Boston_transform %&gt;% 
  mutate(row_id = row_number()) %&gt;% 
  select(row_id, everything())

# Add flag to the Cook&#39;s Distance Diagnosed Observation
Boston_outlier_1tbl &lt;- Boston_row_tbl %&gt;% 
  mutate(row_id = row_number(),
         cooksd_flag = case_when(row_id %in% cooksd_outlier_detect(lm_fit_01edit) ~ 1,
                                TRUE ~ 0)) %&gt;% 
  # filter these observation set 
  filter(cooksd_flag == 1) %&gt;%  
  # Detect IQR out-of-bound outliers and convert to NA values  
  mutate_at(vars(lcrim:srlstat), ~ detect_outliers_to_na(.)) %&gt;% 
  # Replace NA to mean value 
  mutate_at(vars(lcrim:srlstat), function(x) replace(x, is.na(x), mean(x, na.rm = TRUE))) %&gt;% 
  # bind with rest of the observation 
  bind_rows(Boston_row_tbl[-cooksd_outlier_detect(lm_fit_01edit),]) %&gt;% 
  arrange(row_id) %&gt;% 
  select(-c(cooksd_flag)) 

# 02Edit linear model: Outlier Detection + Treatment Iteration 
lm_fit_02edit &lt;- lm(lmedv~.-row_id, data = Boston_outlier_1tbl); summary(lm_fit_02edit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = lmedv ~ . - row_id, data = Boston_outlier_1tbl)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.75916 -0.10917 -0.00429  0.09838  0.75845 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.113844   0.369653  11.129  &lt; 2e-16 ***
## lcrim       -0.139921   0.019907  -7.029 6.99e-12 ***
## zn           0.009357   0.005400   1.733  0.08375 .  
## lindus      -0.021086   0.021301  -0.990  0.32271    
## chas         0.094843   0.036854   2.574  0.01036 *  
## lnox        -0.705555   0.259197  -2.722  0.00672 ** 
## lrm          0.492301   0.112185   4.388 1.40e-05 ***
## sqage        0.006451   0.004651   1.387  0.16608    
## ldis        -0.242995   0.035153  -6.912 1.48e-11 ***
## lrad         0.118565   0.020420   5.806 1.15e-08 ***
## ltax        -0.118905   0.044916  -2.647  0.00837 ** 
## eptratio    -0.034134   0.007883  -4.330 1.81e-05 ***
## black        0.036768   0.011402   3.225  0.00135 ** 
## srlstat     -0.248084   0.015800 -15.702  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1913 on 492 degrees of freedom
## Multiple R-squared:  0.7865, Adjusted R-squared:  0.7809 
## F-statistic: 139.4 on 13 and 492 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code># Treated 3 observation out of 24: the 21 observations are influential data points attributed by the Y values. 
cooksd_outlier_detect(lm_fit_02edit)</code></pre>
<pre><code>##  [1]   8   9 149 215 368 369 370 372 373 375 381 399 400 401 402 406 410 413 417
## [20] 420 490 491 506</code></pre>
<pre class="r"><code>cooksd_outlier_plot(lm_fit_02edit)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre><code>## integer(0)</code></pre>
<pre class="r"><code>plot(lm_fit_02edit)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-16-2.png" width="672" /><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-16-3.png" width="672" /><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-16-4.png" width="672" /><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-16-5.png" width="672" /></p>
<pre class="r"><code># Remove thes Cook&#39;s distance diagnosed outliers 
Boston_outlier_2tbl &lt;- Boston_outlier_1tbl %&gt;% 
  filter(!row_id %in% cooksd_outlier_detect(lm_fit_02edit)) </code></pre>
<pre class="r"><code># 03Edit linear model: Cook&#39;s Distance Outiler Deletion 
lm_fit_03edit &lt;- lm(lmedv~.-row_id, data = Boston_outlier_2tbl); summary(lm_fit_03edit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = lmedv ~ . - row_id, data = Boston_outlier_2tbl)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.55865 -0.09297 -0.00368  0.08359  0.49244 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.739611   0.304941   8.984  &lt; 2e-16 ***
## lcrim       -0.095181   0.016776  -5.674 2.45e-08 ***
## zn           0.005664   0.004055   1.397 0.163185    
## lindus      -0.012002   0.016034  -0.749 0.454504    
## chas         0.094667   0.027627   3.427 0.000665 ***
## lnox        -0.290096   0.201664  -1.439 0.150955    
## lrm          1.009030   0.096111  10.499  &lt; 2e-16 ***
## sqage       -0.005823   0.003678  -1.583 0.114068    
## ldis        -0.196255   0.027769  -7.067 5.75e-12 ***
## lrad         0.069634   0.015998   4.353 1.65e-05 ***
## ltax        -0.117336   0.036032  -3.256 0.001210 ** 
## eptratio    -0.032212   0.005956  -5.409 1.01e-07 ***
## black        0.055959   0.008909   6.281 7.68e-10 ***
## srlstat     -0.186806   0.013588 -13.748  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1433 on 469 degrees of freedom
## Multiple R-squared:  0.8577, Adjusted R-squared:  0.8538 
## F-statistic: 217.5 on 13 and 469 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>cooksd_outlier_plot(lm_fit_03edit)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre><code>## integer(0)</code></pre>
<pre class="r"><code>plot(lm_fit_03edit)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-17-2.png" width="672" /><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-17-3.png" width="672" /><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-17-4.png" width="672" /><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-17-5.png" width="672" /></p>
<pre class="r"><code>glance(lm_fit_03edit) %&gt;% kbl %&gt;% kable_material()</code></pre>
<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
r.squared
</th>
<th style="text-align:right;">
adj.r.squared
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:right;">
deviance
</th>
<th style="text-align:right;">
df.residual
</th>
<th style="text-align:right;">
nobs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.8577047
</td>
<td style="text-align:right;">
0.8537604
</td>
<td style="text-align:right;">
0.1432677
</td>
<td style="text-align:right;">
217.4586
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
260.2448
</td>
<td style="text-align:right;">
-490.4896
</td>
<td style="text-align:right;">
-427.7893
</td>
<td style="text-align:right;">
9.626516
</td>
<td style="text-align:right;">
469
</td>
<td style="text-align:right;">
483
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="data-partitioning-traintest-73" class="section level2">
<h2>Data Partitioning: train:test (7:3)</h2>
<pre class="r"><code>Boston_prepared &lt;- Boston_outlier_2tbl %&gt;% select(-row_id)

set.seed(42)
tidy_split &lt;- initial_split(Boston_prepared, prop = .7,
                            strata = lmedv)
Boston_tr &lt;- training(tidy_split)
Boston_te &lt;- testing(tidy_split)</code></pre>
</div>
<div id="variable-selection-best-subsets-selection-optimal-dimension" class="section level2">
<h2>Variable Selection: Best Subsets Selection &amp; Optimal Dimension</h2>
<p>Optimal number of variables: consideration process by computation of best model with each subsets.</p>
<p>Finding:</p>
<p>[1] Method: “Forward” and “Backward”
Minimum Sum of error and both maxmium adjusted R squared and R squared achieved at total number of variables (13). However, minimum BIC, probabilistic approach, suggests 10 variables is at its optimal.</p>
<p>[2] Method: “Sequential Replacement” (stepwise)
Suggests the variable importance of srlstat and black have on the estmimate parameters.</p>
<pre class="r"><code>regsubfit_full &lt;- regsubsets(lmedv~.,
                        data= Boston_tr, 
                        intercept = T,
                        method = c(&quot;exhaustive&quot;),
                        nvmax = 13)

regfit_summary &lt;- summary(regsubfit_full)

regfit_summary$outmat %&gt;% kbl %&gt;% kable_material()</code></pre>
<table class=" lightable-material" style='font-family: "Source Sans Pro", helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
lcrim
</th>
<th style="text-align:left;">
zn
</th>
<th style="text-align:left;">
lindus
</th>
<th style="text-align:left;">
chas
</th>
<th style="text-align:left;">
lnox
</th>
<th style="text-align:left;">
lrm
</th>
<th style="text-align:left;">
sqage
</th>
<th style="text-align:left;">
ldis
</th>
<th style="text-align:left;">
lrad
</th>
<th style="text-align:left;">
ltax
</th>
<th style="text-align:left;">
eptratio
</th>
<th style="text-align:left;">
black
</th>
<th style="text-align:left;">
srlstat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1 ( 1 )
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
2 ( 1 )
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
3 ( 1 )
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
4 ( 1 )
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
5 ( 1 )
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
6 ( 1 )
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
7 ( 1 )
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
8 ( 1 )
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
9 ( 1 )
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
10 ( 1 )
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
11 ( 1 )
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
12 ( 1 )
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
13 ( 1 )
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
</tbody>
</table></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<pre class="r"><code>opt_adjr2 &lt;- which.max(regfit_summary$adjr2)
opt_bic &lt;- which.min(regfit_summary$bic)

plot(regfit_summary$adjr2, xlab=&quot;No. of Predictor Variables&quot;, ylab=&quot;adj.RSquare&quot;, type=&quot;l&quot;) +points(opt_adjr2, regfit_summary$adjr2[opt_adjr2], col = &quot;red&quot;, cex=2, pch=20)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre><code>## integer(0)</code></pre>
<pre class="r"><code>plot(regfit_summary$bic, xlab=&quot;No. of Predictor Variables&quot;, ylab=&quot;BIC&quot;, type=&quot;l&quot;) +
  points(opt_bic, regfit_summary$bic[opt_bic], col = &quot;red&quot;, cex=2, pch=20)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-20-2.png" width="672" /></p>
<pre><code>## integer(0)</code></pre>
<pre class="r"><code>plot(regfit_summary$rss, xlab=&quot;No. of Predictor Variables&quot;, ylab=&quot;RSS&quot;, type=&quot;l&quot;) </code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-20-3.png" width="672" /></p>
</div>
<div id="linear-model-predcition" class="section level2">
<h2>Linear Model Predcition</h2>
<p>Steps</p>
<p>[1] Split Data (Done)</p>
<p>[2] Feature Engineering (Done)</p>
<p>[3] Specify a Model:</p>
<ul>
<li>specify our linear regression model with parsnip.</li>
</ul>
<div id="vip-variable-of-importance" class="section level4">
<h4>VIP: Variable of Importance</h4>
<pre class="r"><code>lm_model &lt;- linear_reg() %&gt;% 
            set_engine(&#39;lm&#39;) %&gt;% 
            set_mode(&#39;regression&#39;)

lmfit_00tr &lt;- lm_model %&gt;% 
  fit(lmedv ~., data = Boston_tr)

tidy(lmfit_00tr) %&gt;% kbl %&gt;% kable_material()</code></pre>
<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
2.9811264
</td>
<td style="text-align:right;">
0.3655766
</td>
<td style="text-align:right;">
8.154587
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
lcrim
</td>
<td style="text-align:right;">
-0.0993706
</td>
<td style="text-align:right;">
0.0202830
</td>
<td style="text-align:right;">
-4.899198
</td>
<td style="text-align:right;">
0.0000015
</td>
</tr>
<tr>
<td style="text-align:left;">
zn
</td>
<td style="text-align:right;">
0.0061077
</td>
<td style="text-align:right;">
0.0049019
</td>
<td style="text-align:right;">
1.245989
</td>
<td style="text-align:right;">
0.2136744
</td>
</tr>
<tr>
<td style="text-align:left;">
lindus
</td>
<td style="text-align:right;">
-0.0243457
</td>
<td style="text-align:right;">
0.0185979
</td>
<td style="text-align:right;">
-1.309061
</td>
<td style="text-align:right;">
0.1914472
</td>
</tr>
<tr>
<td style="text-align:left;">
chas
</td>
<td style="text-align:right;">
0.0996421
</td>
<td style="text-align:right;">
0.0312996
</td>
<td style="text-align:right;">
3.183493
</td>
<td style="text-align:right;">
0.0015972
</td>
</tr>
<tr>
<td style="text-align:left;">
lnox
</td>
<td style="text-align:right;">
-0.4565157
</td>
<td style="text-align:right;">
0.2335500
</td>
<td style="text-align:right;">
-1.954681
</td>
<td style="text-align:right;">
0.0514858
</td>
</tr>
<tr>
<td style="text-align:left;">
lrm
</td>
<td style="text-align:right;">
0.9133291
</td>
<td style="text-align:right;">
0.1162822
</td>
<td style="text-align:right;">
7.854419
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
sqage
</td>
<td style="text-align:right;">
-0.0046146
</td>
<td style="text-align:right;">
0.0042350
</td>
<td style="text-align:right;">
-1.089630
</td>
<td style="text-align:right;">
0.2766907
</td>
</tr>
<tr>
<td style="text-align:left;">
ldis
</td>
<td style="text-align:right;">
-0.2300286
</td>
<td style="text-align:right;">
0.0336884
</td>
<td style="text-align:right;">
-6.828125
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
lrad
</td>
<td style="text-align:right;">
0.0976265
</td>
<td style="text-align:right;">
0.0185825
</td>
<td style="text-align:right;">
5.253688
</td>
<td style="text-align:right;">
0.0000003
</td>
</tr>
<tr>
<td style="text-align:left;">
ltax
</td>
<td style="text-align:right;">
-0.1213053
</td>
<td style="text-align:right;">
0.0421748
</td>
<td style="text-align:right;">
-2.876250
</td>
<td style="text-align:right;">
0.0042926
</td>
</tr>
<tr>
<td style="text-align:left;">
eptratio
</td>
<td style="text-align:right;">
-0.0287482
</td>
<td style="text-align:right;">
0.0074074
</td>
<td style="text-align:right;">
-3.881000
</td>
<td style="text-align:right;">
0.0001262
</td>
</tr>
<tr>
<td style="text-align:left;">
black
</td>
<td style="text-align:right;">
0.0686069
</td>
<td style="text-align:right;">
0.0105331
</td>
<td style="text-align:right;">
6.513475
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
srlstat
</td>
<td style="text-align:right;">
-0.1888897
</td>
<td style="text-align:right;">
0.0159761
</td>
<td style="text-align:right;">
-11.823304
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>glance(lmfit_00tr) %&gt;% kbl %&gt;% kable_material()</code></pre>
<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
r.squared
</th>
<th style="text-align:right;">
adj.r.squared
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:right;">
deviance
</th>
<th style="text-align:right;">
df.residual
</th>
<th style="text-align:right;">
nobs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.8550502
</td>
<td style="text-align:right;">
0.8491982
</td>
<td style="text-align:right;">
0.1423718
</td>
<td style="text-align:right;">
146.1122
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
185.3558
</td>
<td style="text-align:right;">
-340.7117
</td>
<td style="text-align:right;">
-283.455
</td>
<td style="text-align:right;">
6.526857
</td>
<td style="text-align:right;">
322
</td>
<td style="text-align:right;">
336
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>lmfit_00tr %&gt;% 
  vip(aesthetics = list(fill = viridisLite::viridis(n = 20)[3], col = &quot;yellow&quot;),
      mapping = aes_string(color = &quot;Sign&quot;))</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code>lmfit &lt;- lm(lmedv~., Boston_tr)
backward &lt;- stats::step(lmfit, direction = &quot;backward&quot;, trace = 0)
forward &lt;- stats::step(lmfit, direction = &quot;forward&quot;, trace = 0)
stepwise &lt;- stats::step(lmfit, direction = &quot;both&quot;, trace = 0)

p1_back &lt;- backward %&gt;% vip(num_features = length(coef(backward)), 
          geom = &quot;point&quot;, horizontal = FALSE,
          mapping = aes_string(color = &quot;Sign&quot;, size = 5)) + 
  scale_color_viridis_d() +
    theme(legend.position=&quot;default&quot;) 

p2_forw &lt;- vip(forward, num_features = length(coef(backward)), 
          geom = &quot;point&quot;, horizontal = FALSE, 
          mapping = aes_string(color = &quot;Sign&quot;, size = 5)) + 
  scale_color_viridis_d() +
    theme(legend.position=&quot;default&quot;) 

p2_step &lt;- vip(stepwise, num_features = length(coef(backward)), 
          geom = &quot;point&quot;, horizontal = FALSE, 
          mapping = aes_string(color = &quot;Sign&quot;, size = 3)) + 
  scale_color_viridis_d() +
  theme(legend.position=&quot;default&quot;) 

grid.arrange(p2_step, p2_forw, ncol = 1)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>[3] Prediction</p>
<pre class="r"><code>Boston_housing_results_lm00 &lt;- predict(lmfit_00tr, new_data = Boston_te) %&gt;%
  bind_cols(Boston_te) %&gt;% 
  mutate(residue = lmedv - .pred) %&gt;% 
  select(.pred, residue, lmedv, everything())</code></pre>
<pre class="r"><code># RMSE on test set
rmse(Boston_housing_results_lm00, 
     truth = lmedv,
     estimate = .pred) %&gt;% kbl %&gt;% kable_material()</code></pre>
<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.metric
</th>
<th style="text-align:left;">
.estimator
</th>
<th style="text-align:right;">
.estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
rmse
</td>
<td style="text-align:left;">
standard
</td>
<td style="text-align:right;">
0.1512553
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>rsq(Boston_housing_results_lm00,
    truth = lmedv,
    estimate = .pred) %&gt;% kbl %&gt;% kable_material()</code></pre>
<table class=" lightable-material" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.metric
</th>
<th style="text-align:left;">
.estimator
</th>
<th style="text-align:right;">
.estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
rsq
</td>
<td style="text-align:left;">
standard
</td>
<td style="text-align:right;">
0.8557721
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>Boston_housing_results_lm00 %&gt;% 
  ggplot(mapping = aes(x = .pred, y = lmedv)) +
  geom_point(color = &#39;#006EA1&#39;) +
  geom_abline(intercept = 0, slope = 1, color = &#39;orange&#39;) +
  labs(title = &#39;Multiple Linear Regression Results: Boston House Price Prediction&#39;,
       x = &#39;Predicted Price&#39;,
       y = &#39;Actual Price&#39;) +
  theme_tq()</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<pre class="r"><code>Boston_housing_results_lm00 %&gt;% 
  ggplot(aes(.pred, residue)) + 
  geom_point() + 
  geom_smooth(method = &quot;lm&quot;, se = FALSE); mean(Boston_housing_results_lm00$residue)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-24-2.png" width="672" /></p>
<pre><code>## [1] -0.01004848</code></pre>
<pre class="r"><code>generator_univar_importance_tbl(Boston_tr, &quot;lmedv&quot;)</code></pre>
<pre><code>## [1] &quot;Response variable: lmedv&quot;</code></pre>
<pre><code>##     varname vartype    R2 R2_log R2_quad max_R2
## 1   srlstat numeric 0.722  0.721   0.725  0.725
## 2       lrm numeric 0.490  0.479   0.510  0.510
## 3     lcrim numeric 0.382  0.317   0.389  0.389
## 4      ltax numeric 0.325  0.323   0.326  0.326
## 5    lindus numeric 0.313  0.293   0.316  0.316
## 6  eptratio numeric 0.293  0.280   0.315  0.315
## 7      lnox numeric 0.270  0.272   0.274  0.274
## 8     sqage numeric 0.247  0.161   0.252  0.252
## 9      lrad numeric 0.192  0.141   0.238  0.238
## 10    black numeric 0.220  0.150   0.224  0.224
## 11     ldis numeric 0.168  0.188   0.205  0.205
## 12       zn numeric 0.152  0.172   0.167  0.172
## 13     chas numeric 0.011  0.011   0.011  0.011
## 14    lmedv numeric    NA     NA      NA     NA</code></pre>
</div>
</div>
